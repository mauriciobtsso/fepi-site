{% extends 'painel/base_painel.html' %}
{% block content %}

<div class="row mb-4">
    <div class="col-12">
        <h2><i class="fas fa-sitemap me-2"></i> Estrutura Organizacional</h2>
        <p class="text-muted">Gerencie quem faz parte da diretoria e dos departamentos.</p>
    </div>
</div>

<ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
    <li class="nav-item">
        <button class="nav-link active fw-bold" id="membros-tab" data-bs-toggle="tab" data-bs-target="#membros" type="button">
            <i class="fas fa-users me-2"></i> Membros da Diretoria
        </button>
    </li>
    <li class="nav-item">
        <button class="nav-link fw-bold" id="deptos-tab" data-bs-toggle="tab" data-bs-target="#deptos" type="button">
            <i class="fas fa-building me-2"></i> Departamentos
        </button>
    </li>
    <li class="nav-item">
        <button class="nav-link fw-bold" id="cargos-tab" data-bs-toggle="tab" data-bs-target="#cargos" type="button">
            <i class="fas fa-id-badge me-2"></i> Lista de Cargos
        </button>
    </li>
</ul>

<div class="tab-content" id="myTabContent">
    
    <div class="tab-pane fade show active" id="membros">
        <div class="d-flex justify-content-end mb-3">
            <a href="{% url 'novo_membro' %}" class="btn btn-primary"><i class="fas fa-plus"></i> Novo Membro</a>
        </div>
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light"><tr><th>Nome</th><th>Cargo / Depto</th><th>Contato</th><th class="text-end pe-4">Ações</th></tr></thead>
                    <tbody>
                        {% for m in membros %}
                        <tr>
                            <td class="ps-4 fw-bold">{{ m.nome }}</td>
                            <td>
                                <span class="badge bg-primary">{{ m.cargo.nome }}</span><br>
                                <small class="text-muted">{{ m.tipo.nome }}</small>
                            </td>
                            <td><small>{{ m.email }}<br>{{ m.telefone }}</small></td>
                            <td class="text-end pe-4">
                                <a href="{% url 'editar_membro' m.id %}" class="btn btn-sm btn-outline-primary"><i class="fas fa-edit"></i></a>
                                <a href="{% url 'excluir_membro' m.id %}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Excluir?')"><i class="fas fa-trash"></i></a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="4" class="text-center py-4">Nenhum membro cadastrado.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane fade" id="deptos">
        <div class="d-flex justify-content-end mb-3">
            <a href="{% url 'novo_departamento' %}" class="btn btn-success"><i class="fas fa-plus"></i> Novo Departamento</a>
        </div>
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light"><tr><th>Ordem</th><th>Nome do Departamento</th><th>Descrição</th><th class="text-end pe-4">Ações</th></tr></thead>
                    <tbody>
                        {% for d in departamentos %}
                        <tr>
                            <td class="ps-4">{{ d.ordem }}</td>
                            <td class="fw-bold">{{ d.nome }}</td>
                            <td class="text-muted small">{{ d.descricao }}</td>
                            <td class="text-end pe-4">
                                <a href="{% url 'editar_departamento' d.id %}" class="btn btn-sm btn-outline-primary"><i class="fas fa-edit"></i></a>
                                <a href="{% url 'excluir_departamento' d.id %}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Excluir?')"><i class="fas fa-trash"></i></a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane fade" id="cargos">
        <div class="alert alert-info small"><i class="fas fa-info-circle"></i> Cadastre cargos genéricos (ex: "Diretor", "Secretário") para reutilizar em vários departamentos.</div>
        <div class="d-flex justify-content-end mb-3">
            <a href="{% url 'novo_cargo' %}" class="btn btn-secondary"><i class="fas fa-plus"></i> Novo Cargo</a>
        </div>
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light"><tr><th>Nome do Cargo</th><th class="text-end pe-4">Ações</th></tr></thead>
                    <tbody>
                        {% for c in cargos %}
                        <tr>
                            <td class="ps-4">{{ c.nome }}</td>
                            <td class="text-end pe-4">
                                <a href="{% url 'editar_cargo' c.id %}" class="btn btn-sm btn-outline-primary"><i class="fas fa-edit"></i></a>
                                <a href="{% url 'excluir_cargo' c.id %}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Excluir?')"><i class="fas fa-trash"></i></a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>
{% endblock %}