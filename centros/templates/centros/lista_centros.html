{% extends 'core/base.html' %}
{% load static %}

{% block title %}Centros Esp√≠ritas - FEPI{% endblock %}

{% block extra_css %}
<style>
    /* Busca */
    .search-container { background-color: var(--azul-claro); padding: 20px; border-radius: 8px; margin-bottom: 25px; text-align: center; }
    .search-form { display: flex; max-width: 500px; margin: 0 auto; gap: 8px; }
    .search-input { flex: 1; padding: 8px 15px; border-radius: 20px; border: 1px solid #ccc; outline: none; font-size: 0.95rem; }
    .search-btn { background-color: var(--azul-escuro); color: white; border: none; padding: 0 20px; border-radius: 20px; cursor: pointer; font-size: 0.9rem;}

    /* LISTA SUPER COMPACTA */
    .lista-compacta { display: flex; flex-direction: column; gap: 8px; }

    .item-centro {
        display: grid;
        /* Grid: Logo | Info | Bot√µes */
        grid-template-columns: 50px 1fr auto;
        align-items: center;
        background: white;
        padding: 10px 15px; /* Padding reduzido */
        border-radius: 6px;
        border: 1px solid #eee;
        gap: 15px;
        transition: 0.2s;
    }
    .item-centro:hover { border-color: var(--dourado); transform: translateX(3px); }

    /* Logo Pequena */
    .centro-img {
        width: 45px; height: 45px; object-fit: contain;
        border-radius: 50%; border: 1px solid #eee; background: #f9f9f9;
    }
    
    /* Texto */
    .centro-main { display: flex; flex-direction: column; line-height: 1.2; }
    .nome { font-weight: 700; color: var(--azul-escuro); font-size: 1rem; }
    .endereco { font-size: 0.8rem; color: #555; margin-top: 2px; }
    .detalhes-extra { font-size: 0.75rem; color: #888; margin-top: 2px; display: flex; gap: 10px; }

    /* √Årea de Bot√µes */
    .acoes { display: flex; gap: 8px; align-items: center; }

    .btn-mini {
        font-size: 0.75rem; font-weight: 600; padding: 4px 10px;
        border-radius: 4px; text-decoration: none; display: flex; align-items: center; gap: 4px;
        transition: 0.2s;
    }
    .btn-rota { background-color: #e0f2f1; color: #006d77; }
    .btn-rota:hover { background-color: #006d77; color: white; }
    
    .btn-site { background-color: #fce4ec; color: #c2185b; }
    .btn-site:hover { background-color: #c2185b; color: white; }

    /* T√≠tulos */
    .grupo-titulo {
        color: var(--azul-escuro); font-size: 1.1rem; font-weight: 700;
        margin: 25px 0 10px 0; border-bottom: 1px solid #eee; padding-bottom: 5px;
    }

    /* Mobile */
    @media (max-width: 600px) {
        .item-centro { grid-template-columns: 1fr; gap: 8px; }
        .centro-img { display: none; } /* Esconde logo no mobile para poupar espa√ßo */
        .acoes { justify-content: flex-start; margin-top: 5px; }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    
    <div class="section-header" style="margin-bottom: 1rem;">
        <div>
            <h2 style="font-size: 1.5rem;">Encontre um Centro Esp√≠rita</h2>
        </div>
    </div>

    <div class="search-container">
        <form method="GET" action="." class="search-form">
            <input type="text" name="q" class="search-input" placeholder="Pesquisar..." value="{{ busca_ativa|default:'' }}">
            <button type="submit" class="search-btn">üîç</button>
        </form>
    </div>

    {% if not capital and not interior and not especializadas %}
        <p style="text-align:center; color:#888;">Nenhum centro encontrado.</p>
    {% endif %}

    {% if capital %}
    <h3 class="grupo-titulo">Teresina ({{ capital|length }})</h3>
    <div class="lista-compacta">
        {% for centro in capital %}
        <div class="item-centro">
            {% if centro.foto %}
                <img src="{{ centro.foto.url }}" class="centro-img">
            {% else %}
                <div class="centro-img" style="display:flex; align-items:center; justify-content:center; color:#ccc; font-size:0.7rem;">FE</div>
            {% endif %}

            <div class="centro-main">
                <span class="nome">{{ centro.nome }}</span>
                <span class="endereco">{{ centro.bairro }} ‚Ä¢ {{ centro.endereco }}{% if centro.numero %}, {{ centro.numero }}{% endif %}</span>
                
                <div class="detalhes-extra">
                    {% if centro.telefone %}<span>üìû {{ centro.telefone }}</span>{% endif %}
                    {% if centro.data_fundacao %}<span>üéÇ {{ centro.data_fundacao|date:"Y" }}</span>{% endif %}
                </div>
            </div>

            <div class="acoes">
                {% if centro.site %}
                <a href="{{ centro.site }}" target="_blank" class="btn-mini btn-site" title="Instagram/Site">
                    üåê Link
                </a>
                {% endif %}
                
                <a href="https://www.google.com/maps/search/?api=1&query={{ centro.endereco }} {{ centro.numero }} {{ centro.cidade }}" target="_blank" class="btn-mini btn-rota" title="Ver no Mapa">
                    üìç Mapa
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if interior %}
    <h3 class="grupo-titulo">Interior ({{ interior|length }})</h3>
    <div class="lista-compacta">
        {% for centro in interior %}
        <div class="item-centro">
            <div class="centro-img" style="display:flex; align-items:center; justify-content:center; color:#ccc; font-size:0.7rem;">FE</div>
            
            <div class="centro-main">
                <span class="nome">{{ centro.nome }}</span>
                <span class="endereco"><strong>{{ centro.cidade }}</strong> ‚Ä¢ {{ centro.endereco }}</span>
                <div class="detalhes-extra">
                    {% if centro.telefone %}<span>üìû {{ centro.telefone }}</span>{% endif %}
                </div>
            </div>

            <div class="acoes">
                {% if centro.site %}
                <a href="{{ centro.site }}" target="_blank" class="btn-mini btn-site">üåê</a>
                {% endif %}
                <a href="https://www.google.com/maps/search/?api=1&query={{ centro.endereco }} {{ centro.cidade }} Piaui" target="_blank" class="btn-mini btn-rota">üìç Mapa</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if especializadas %}
    <h3 class="grupo-titulo">Especializadas</h3>
    <div class="lista-compacta">
        {% for centro in especializadas %}
        <div class="item-centro">
            <div class="centro-img" style="display:flex; align-items:center; justify-content:center; color:#ccc; font-size:0.7rem;">FE</div>
            <div class="centro-main">
                <span class="nome">{{ centro.nome }}</span>
                <span class="endereco">{{ centro.endereco }}</span>
            </div>
            <div class="acoes">
                <a href="https://www.google.com/maps/search/?api=1&query={{ centro.endereco }} Teresina" target="_blank" class="btn-mini btn-rota">üìç Mapa</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

</div>
{% endblock %}